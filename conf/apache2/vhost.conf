# HTTP Virtual Host Configuration
# This file defines the main HTTP virtual host

<VirtualHost *:80>
    # Server identification
    ServerAdmin webmaster@localhost
    ServerName localhost
    
    # Document root
    DocumentRoot /var/www/html
    
    # Directory configuration
    <Directory /var/www/html>
        Options Indexes FollowSymLinks MultiViews
        AllowOverride All
        Require all granted
        
        # Enable directory browsing if no index file
        DirectoryIndex index.php index.html index.htm
    </Directory>
    
    # Logging
    ErrorLog /var/log/lamp/apache-error.log
    CustomLog /var/log/lamp/apache-access.log combined
    
    # PHP-FPM default handler (can be overridden by .htaccess)
    <FilesMatch \.php$>
        SetHandler "proxy:fcgi://127.0.0.1:9083"
    </FilesMatch>
    
    # Deny access to sensitive files
    <FilesMatch "^\.">
        Require all denied
    </FilesMatch>
    
    # Deny access to backup and config files
    <FilesMatch "\.(bak|config|sql|fla|psd|ini|log|sh|inc|swp|dist)$">
        Require all denied
    </FilesMatch>
    
    # phpMyAdmin configuration
    Alias /phpmyadmin /var/www/html/phpmyadmin
    <Directory /var/www/html/phpmyadmin>
        Options FollowSymLinks
        DirectoryIndex index.php
        AllowOverride All
        Require all granted
    </Directory>
    
    # TinyFileManager configuration
    Alias /filemanager /var/www/html/filemanager
    <Directory /var/www/html/filemanager>
        Options FollowSymLinks
        DirectoryIndex index.php
        AllowOverride All
        Require all granted
    </Directory>
    
</VirtualHost>
