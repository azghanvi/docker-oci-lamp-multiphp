# Apache Security Configuration
# This file contains security-related directives and headers

# ServerTokens
# This directive configures what you return as the Server HTTP response header
# Set to "Prod" to only return "Apache" in the Server header
ServerTokens Prod

# ServerSignature
# This directive configures the footer on server-generated documents
# Set to "Off" to disable the footer
ServerSignature Off

# Trace HTTP Method
# Disable TRACE HTTP method to prevent Cross-Site Tracing attacks
TraceEnable Off

# Security Headers
<IfModule mod_headers.c>
    # Prevent MIME type sniffing
    Header always set X-Content-Type-Options "nosniff"
    
    # Enable XSS Protection (for older browsers)
    Header always set X-XSS-Protection "1; mode=block"
    
    # Prevent clickjacking attacks
    Header always set X-Frame-Options "SAMEORIGIN"
    
    # Referrer Policy
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
    
    # Content Security Policy (Basic - adjust as needed)
    # Uncomment and modify for your needs
    # Header always set Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline';"
    
    # Remove server information from headers
    Header unset Server
    Header unset X-Powered-By
    
    # Strict Transport Security (HTTPS only)
    # Uncomment if using HTTPS in production
    # Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains"
</IfModule>

# Disable directory listing by default
<IfModule mod_autoindex.c>
    Options -Indexes
</IfModule>

# Protect sensitive files
<FilesMatch "(^#.*#|\.(bak|conf|dist|fla|in[ci]|log|psd|sh|sql|sw[op])|~)$">
    Require all denied
</FilesMatch>

# Deny access to version control directories
<DirectoryMatch "/\.git">
    Require all denied
</DirectoryMatch>

<DirectoryMatch "/\.svn">
    Require all denied
</DirectoryMatch>

# Deny access to composer files
<FilesMatch "composer\.(json|lock)">
    Require all denied
</FilesMatch>

# Deny access to package manager files
<FilesMatch "(package|package-lock)\.json">
    Require all denied
</FilesMatch>

# Deny access to environment files
<FilesMatch "^\.env">
    Require all denied
</FilesMatch>

# Limit file upload size (can be overridden in PHP)
LimitRequestBody 134217728

# Set timeout for slow loris protection
Timeout 60

# Disable ETag for security
FileETag None
